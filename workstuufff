metrics = [
    "Allowance for expected Credit Losses (S1)Stage 1",
    "Allowance for expected Credit Losses (S2)Stage 2",
    "Allowance for expected Credit Losses (S3)Stage 3",
]

# the quarter columns are numeric: 0, 1, ..., 12
qcols = [c for c in QA_result.columns if isinstance(c, int)]

for m in metrics:
    # FCR Other Consumer row (source)
    fcr_other = df_fcr_mx.loc[
        (df_fcr_mx["mapped_metric"] == m) &
        (df_fcr_mx["mapped_prd"] == "Other Consumer"),
        qcols
    ]

    # QA_result Indirect Auto row (to subtract)
    qa_ind = QA_result.loc[
        (QA_result["mapped_metric"] == m) &
        (QA_result["mapped_prd"] == "Indirect Auto"),
        qcols
    ]

    # update QA_result Other Consumer row
    QA_result.loc[
        (QA_result["mapped_metric"] == m) &
        (QA_result["mapped_prd"] == "Other Consumer"),
        qcols
    ] = fcr_other.to_numpy() - qa_ind.to_numpy()


