# Around your merge section, add this logic:
for quarter in ['Q1_val', 'Q2_val', 'Q3_val', 'Q4_val']:  # adjust column names as needed
    provision_mask = template_actual['Metric'].str.contains('Provision for Credit Losses')
    
    for idx in template_actual[provision_mask].index:
        product_type = template_actual.loc[idx, 'Asset Class/Product Type']
        
        # Check if "Other Consumer" needs to be summed
        if product_type == "Other Consumer":
            other_consumer_val = merged_data[
                (merged_data['Product_Map'] == 'Other Consumer') & 
                (merged_data['Metric'] == template_actual.loc[idx, 'Metric'])
            ][quarter].sum() if not merged_data[...].empty else 0
            
            personal_loans_val = merged_data[
                (merged_data['Product_Map'] == 'Personal Instalment Loans') & 
                (merged_data['Metric'] == template_actual.loc[idx, 'Metric'])
            ][quarter].sum() if not merged_data[...].empty else 0
            
            template_actual.loc[idx, quarter] = other_consumer_val + personal_loans_val
