# Keep ALL your existing code exactly as is, then add just this at the end:

# Simple fix: Just override "Other Consumer" rows with aggregated values
other_consumer_mask = template_actual['Asset Class/Product Type'] == 'Other Consumer'

for idx in template_actual[other_consumer_mask].index:
    metric_map = template_actual.at[idx, 'Metric_Map']
    
    if pd.notna(metric_map):
        # For each quarter, sum "Other Consumer" + "Small Business"
        for quarter_df, col_name in [
            (df2024q1, 'SY0 Q1'),
            (df2024q2, 'SY0 Q2'),
            (df2024q3, 'SY0 Q3'), 
            (df2024q4, 'SY0 Q4')
        ]:
            oc_val = quarter_df[(quarter_df['Portfolio'] == 'Other Consumer') & 
                               (quarter_df['Metric'] == metric_map)]['Q1 2024'].sum()  # Adjust column name
            sb_val = quarter_df[(quarter_df['Portfolio'] == 'Small Business') & 
                               (quarter_df['Metric'] == metric_map)]['Q1 2024'].sum()  # Adjust column name
            
            if oc_val > 0 or sb_val > 0:
                template_actual.at[idx, col_name] = oc_val + sb_val

print("âœ… Other Consumer aggregation complete!")
